os: WMF 5

version: '{build}'

platform:
  - x86
#  - x64
  
environment:
  gitHubToken:
    secure: 
  psGalleryKey:
    secure:
  
init:
  - WhoAmI
  
install:
  - ps: Install-PackageProvider NuGet -Force | Out-Null
  - ps: Install-Module Pester -Force
#  - ps: Install-Module PSScriptAnalyzer -Force
  - ps: Install-Module DevTools -Force

before_build:
  - ps: dt Shortcuts
  - ps: Uninstall-Module DevTools

build_script:
  - ps: dt Build

test_script:
  - ps: dt Test
  
after_test:
  - ps: dt Cleanup
  
build: on

branches:
  only:
    - master
    
artifacts:
  - path: test
  - path: logs
  - path: $env:APPVEYOR_PROJECT_NAME
    name: myapp

deploy:
  release: myproduct-v1
  description: 'Release description'
  provider: GitHub
  artifact: devtools-1.1.4.zip 
  draft: false
  prerelease: false
  on:
    branch: master                 
    appveyor_repo_tag: flase        # deploy on tag push only